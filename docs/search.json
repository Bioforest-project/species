[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "species",
    "section": "",
    "text": "Introduction\nspecies is a sub-project of the BioForest project aimed at species related data (correct names, functional traits, phylogeny) as part of the data preparation for data preparation within the project."
  },
  {
    "objectID": "index.html#usage",
    "href": "index.html#usage",
    "title": "species",
    "section": "Usage",
    "text": "Usage\nAll species analyses rely on the quarto documents (files.qmd) that can be run with R and associated environment defined with renv."
  },
  {
    "objectID": "index.html#project",
    "href": "index.html#project",
    "title": "species",
    "section": "Project",
    "text": "Project\nspecies includes:\n\nAnalyse of the data with associated documentation and figures:\n\nReproductive analyses in files.qmd\nResulting pages in docs/\nDocument structure definition in _quarto.yml\n\nData in data/ with:\n\nAll raw data in raw_data/\nAll derived data in derived_sata/\n\nR scripts with funtions in r/\nIntermediary files in outputs/\nFigures in figures/\nR environment definition with renv in renv/ and renv/lock\nR files (.Rbuildignore , .Rdata , .Rprofile , .Rhistory, .lintr)\nGit and GitHub files (.gitignore , .github/)\nProject documentation (README.qmd , README.md , NEWS.md, LICENSE )"
  },
  {
    "objectID": "index.html#contribution",
    "href": "index.html#contribution",
    "title": "species",
    "section": "Contribution",
    "text": "Contribution\nYou can contribute to the project by forking the repository on github and cloning the fork to your machine using several options, including GitHub desktop GUI. Further informations on contribution are detailed in the online document: https://bioforest-project.github.io/data_preparation/98_contributing.html."
  },
  {
    "objectID": "index.html#help",
    "href": "index.html#help",
    "title": "species",
    "section": "Help",
    "text": "Help\nPlease preferentially create an issue on GitHub for any questions, bugs or help needed regarding species: https://github.com/Bioforest-project/species/issues . You may however reach us by mail with people from the core group (see below)."
  },
  {
    "objectID": "index.html#core-group",
    "href": "index.html#core-group",
    "title": "species",
    "section": "Core group",
    "text": "Core group\n\nSylvain Schmitt (sylvain.schmitt@cirad.fr)\nCamille Piponiot-Laroche (camille.piponiot-laroche@cirad.fr)\nGéraldine Derroire (geraldine.derroire@cirad.fr)\nMithila Unkule (mithila.unkule@fondationbiodiversite.fr)\nIrié Cazimir Zo-Bi (iczobi@gmail.com)\nAnand Roopsind (aroopsind@gmail.com)\n\nThe whole group consist of participants to the Bioforest project."
  },
  {
    "objectID": "11_raw.html#all",
    "href": "11_raw.html#all",
    "title": "Raw",
    "section": "All",
    "text": "All\nWe first removed Kibale, Lesong, Misiones, Mbaiki, Moju, Peteco, Sg Lalang, and Ulu Muda as taxonomic information is currently contained only either in the vernacular or scientifc column. They should be cleaned before integration.\n\n\nCode\ntaxo &lt;- read_tsv(\"data/raw_data/raw_taxonomy.tsv\") %&gt;%\n  rename_all(tolower) %&gt;%\n  filter(!(site %in% c(\n    \"Kibale\", \"Lesong\", \"Moju\", \"Mbaiki\", \"Peteco\",\n    \"Misiones\", \"Ulu Muda\", \"Sg Lalang\"\n  )))\n\n\nWe had data for 8 sites:\n\n\nCode\ntaxo %&gt;%\n  select(site) %&gt;%\n  unique() %&gt;%\n  summarise(sites = n()) %&gt;%\n  kable(caption = \"Total number of sites.\")\n\n\n\nTotal number of sites.\n\n\nsites\n\n\n\n\n8\n\n\n\n\n\nWe had a 43 to 69 families, with 101 to 256 genera, and with 130 to 762 species corresponding to 198 to 247 vernacular names when registered:\n\n\nCode\ntaxo %&gt;%\n  group_by(site) %&gt;%\n  summarise(\n    family = length(unique(na.omit(family))),\n    genus = length(unique(na.omit(genus))),\n    species = length(unique(paste(genus, species))),\n    scientific = length(unique(na.omit(scientificname))),\n    vernacular = length(unique(na.omit(vernname)))\n  ) %&gt;%\n  kable(caption = \"Numbers per taxonomic levels for each site.\")\n\n\n\nNumbers per taxonomic levels for each site.\n\n\nsite\nfamily\ngenus\nspecies\nscientific\nvernacular\n\n\n\n\nBafog\n58\n196\n258\n385\n211\n\n\nKabo\n53\n154\n197\n270\n0\n\n\nMalinau\n68\n174\n324\n670\n0\n\n\nManare\n50\n142\n212\n276\n197\n\n\nMontagne_Tortue\n50\n153\n217\n298\n201\n\n\nParacou\n64\n256\n463\n762\n247\n\n\nTene\n49\n146\n166\n200\n208\n\n\nUppangala\n43\n101\n115\n130\n0\n\n\n\n\n\nIn total, we thus add 1,140 species before cleaning:\n\n\nCode\ntaxo %&gt;%\n  summarise(\n    family = length(unique(na.omit(family))),\n    genus = length(unique(na.omit(genus))),\n    species = length(unique(paste(genus, species))),\n    scientific = length(unique(na.omit(scientificname))),\n    vernacular = length(unique(na.omit(vernname)))\n  ) %&gt;%\n  kable(\n    format.args = list(big.mark = \",\"),\n    caption = \"Total numbers per taxonomic levels.\"\n  )\n\n\n\nTotal numbers per taxonomic levels.\n\n\nfamily\ngenus\nspecies\nscientific\nvernacular\n\n\n\n\n133\n637\n1,140\n2,121\n506\n\n\n\n\n\nSpecies name construction using genus and species should be preferred as the scientific name column increases diversity with only slight differences:\n\n\nCode\ntaxo %&gt;%\n  mutate(species = paste(genus, species)) %&gt;%\n  select(species, scientificname) %&gt;%\n  unique() %&gt;%\n  group_by(species) %&gt;%\n  mutate(N = n()) %&gt;%\n  ungroup() %&gt;%\n  filter(N == 11) %&gt;%\n  kable(caption = \"Example of multiple scientific names for one species genus pair.\") # nolint\n\n\n\nExample of multiple scientific names for one species genus pair.\n\n\nspecies\nscientificname\nN\n\n\n\n\nShorea parvifolia\nShorea parvifolia Dyer\n11\n\n\nShorea parvifolia\nShorea parvifolia Dyer ssp. parvifolia\n11\n\n\nShorea parvifolia\nShorea parvifolia Dyer ssp.parvifolia\n11\n\n\nShorea parvifolia\nShorea parvifolia Dyer ssp. velutina\n11\n\n\nShorea parvifolia\nShorea parvifolia Dyer.\n11\n\n\nShorea parvifolia\nShorea parvifolia Dter\n11\n\n\nShorea parvifolia\nShorea parvifolia Dyer ssp. Parvifolia\n11\n\n\nShorea parvifolia\nShorea parvifolia Warb.\n11\n\n\nShorea parvifolia\nShorea parvifolia Dyer ssp parvifolia\n11\n\n\nShorea parvifolia\nShorea parvifolia Dyr ssp parvifolia\n11\n\n\nShorea parvifolia\nShorea parvifolia Dyr\n11\n\n\n\n\n\n\n\nCode\ntaxo %&gt;%\n  mutate(species = paste(genus, species)) %&gt;%\n  select(species, scientificname) %&gt;%\n  unique() %&gt;%\n  group_by(species) %&gt;%\n  summarise(N = n()) %&gt;%\n  filter(N &gt; 1) %&gt;%\n  ggplot(aes(N)) +\n  geom_histogram() +\n  theme_bw() +\n  scale_y_sqrt() +\n  scale_x_sqrt() +\n  xlab(\"Scientific names per genus species pairs\") +\n  ylab(\"\")\n\n\n\n\n\nScientific names per genus species pairs."
  },
  {
    "objectID": "11_raw.html#family",
    "href": "11_raw.html#family",
    "title": "Raw",
    "section": "Family",
    "text": "Family\nFamilies includes the following dubious names:\n\nMissing: #N/A, +\nUnidentified: Indet., Not in DB, unid., unidentified\n\nSee the list below:\n\n\nCode\nunique(taxo$family) %&gt;%\n  sort() %&gt;%\n  paste0(collapse = \", \")\n\n\n[1] \" Rubiaceae, #N/A, +, Acanthaceae, Achariaceae, Alangiaceae, Anacardiaceae, Annonaceae, Anonaceae, Apocynaceae, Aquifoliaceae, Araceae, Araliaceae, Araucariaceae, Areacaceae, Arecaceae, Asparagaceae, Bignoniaceae, Bixaceae, Bombacaceae, Boraginaceae, Burseraceae, Calophyllaceae, Cannabaceae, Capparaceae, Cardiopteridaceae, Caricaceae, Carnaraceae, Caryocaraceae, Celastraceae, Chrysobalanaceae, Cluciaceae, Clusiaceae, Combretaceae, Compositae, Connaraceae, Convolvulaceae, Cordiaceae, Cornaceae, Crypteroniaceae, Dichapetalaceae, Dilleniaceae, Dipterocarpaceae, Dipterocarpus, Diptewrocarpaceae, Ebenaceae, Elaeocarpaceae, Erythroxylaceae, Euphobiaceae, Euphorbiaceae, Euphorbuaceae, Fabaceae, Fagaceae, Flacourtiaceae, Gnetaceae, Goupiaceae, Greyiaceae, Humiriaceae, Hypericaceae, Icacinaceae, Indet., Irvingiaceae, Ixonanthaceae, Lacistemataceae, Lamiaceae, Lauraceae, Lecythidaceae, Linaceae, Loganiaceae, Malpighiaceae, Malvaceae, Melastomataceae, Meliaceae, Metteniusaceae, Monimiaceae, Moraceae, Myristicaceae, Myrtaceae, Mytaceae, Not in DB, Nyctaginaceae, Nyssaceae, Ocalaceae, Ochnaceae, Olacaceae, Oleaceae, Opiliaceae, Oxalidaceae, Pandaceae, Pentaphylacaceae, Peraceae, Peridiscaceae, Phyllanthaceae, Picrodendraceae, Podocarpaceae, Polygalaceae, Polygonaceae, Primulaceae, Proteaceae, Putranjavaceae, Putranjivaceae, Quiinaceae, Rhabdodendraceae, Rhamnaceae, Rhizophoraceae, Rosaceae, Rubiaceae, Rutaceae, Sabiaceae, Salicaceae, Santalaceae, Saoindaceae, Sapindaceae, Sapotaceae, Saxipragaceae, Simaroubaceae, Simarubaceae, Siparunaceae, Staphyleaceae, Stemonuraceae, Sterculiaceae, Styracaceae, Symplocaceae, Theaceae, Thymelaceae, Tiliaceae, Ulmaceae, unid., unidentified, Urticaceae, Verbenaceae, Violaceae, Vochysiaceae\"\n\n\nWith the following counts:\n\n\nCode\nunid &lt;- c(\"Indet.\", \"Not in DB\", \"unid.\", \"unidentified\")\nmissing &lt;- c(\"#N/A\", \"+\")\ntaxo %&gt;%\n  select(family) %&gt;%\n  unique() %&gt;%\n  summarise(\n    \"Unidentified\" = sum(family %in% unid,\n      na.omit = TRUE\n    ),\n    \"Missing\" = sum(family %in% missing,\n      na.omit = TRUE\n    )\n  ) %&gt;%\n  gather(\"type\", \"number\") %&gt;%\n  kable(caption = \"Number of family by issue type.\")\n\n\n\nNumber of family by issue type.\n\n\ntype\nnumber\n\n\n\n\nUnidentified\n5\n\n\nMissing\n3"
  },
  {
    "objectID": "11_raw.html#genus",
    "href": "11_raw.html#genus",
    "title": "Raw",
    "section": "Genus",
    "text": "Genus\nGenera includes the following dubious names:\n\nMissing: #N/A,\nUnidentified: Indet.\nFamily-only: Indet.Apocynaceae, Indet.Arecaceae, Indet.Bignoniaceae, Indet.Burseraceae, Indet.Capparaceae, Indet.Chrysobalanaceae, Indet.Clusiaceae, Indet.Combretaceae, Indet.Dichapetalaceae, Indet.Euphorbiaceae, Indet.Fabaceae, Indet.FabaceaeCaesalpinioideae(mimosoid_clade), Indet.FabaceaePapilionoideae, Indet.Humiriaceae, Indet.Indet., Indet.Lamiaceae, Indet.Lauraceae, Indet.Lecythidaceae, Indet.Malvaceae, Indet.MalvaceaeBombacoideae, Indet.Melastomataceae, Indet.Moraceae, Indet.Myrtaceae, Indet.Nyctaginaceae, Indet.Olacaceae, Indet.Rubiaceae, Indet.Salicaceae, Indet.Sapindaceae, Indet.Sapotaceae, Indet.Urticaceae, Indet.Violaceae, Indet.Vochysiaceae\n\nSee the list below:\n\n\nCode\nunique(taxo$genus) %&gt;%\n  sort() %&gt;%\n  paste0(collapse = \", \")\n\n\n[1] \"#N/A, Abarema, Acrocarpus, Actinodaphne, Adinandra, Afzelia, Agathis, Aglaia, Agonandra, Agrostistachys, Aidia, Aiouea, Alangium, Albizia, Alchornea, Alchorneopsis, Alexa, Allophylus, Alseodaphne, Alstonia, Amaioua, Amanoa, Ambelania, Amoora, Ampelocera, Amphimas, Amphiodon, Amphirrhox, Anacardium, Anaxagorea, Andira, Aniba, Anisoptera, Annickia, Annona, Anogeissus, Anthonotha, Antiaris, Antidesma, Antonia, Antrocaryon, Aparisthmium, Apeiba, Aphanamixis, Aporosa, Aptandra, Aquilaria, Archidendron, Arthocarpus, Articarpus, Artocarpus, Aspidosperma, Astrocaryum, Astronium, Attalea, Atuna, Avicennia, Baccaurea, Bactris, Bagassa, Balizia, Banara, Baphia, Baringtonia, Batesia, Beilschmeidia, Beilschmiedia, Bellucia, Bersama, Bhesa, Bixa, Blepharistemma, Blighia, Bocoa, Bombacopsis, Bombax, Brachystegia, Bridelia, Brosimum, Brownlowia, Buchanania, Buchenavia, Buchholzia, Bussea, Byrsonima, Callicarpa, Caloncoba, Calophyllum, Calpocalyx, Calycolpus, Calyptranthes, Canarium, Capirona, Capparidastrum, Caraipa, Carallia, Carapa, Carica, Caryocar, Caryota, Casearia, Cassia, Cassipourea, Castanopsis, Cathedra, Catostemma, Cecropia, Cedrela, Cedrelinga, Ceiba, Celtis, Cephallomappa, Cephalomappa, Chaetacme, Chaetocarpus, Chaunochiton, Cheiloclinium, Chimarrhis, Chionanthes, Chionanthus, Chisecheton, Chisocheton, Christiana, Chrysophyllum, Chukrasia, Cinnamomum, Citharexylum, Clathrotropis, Cleistanthes, Cleistanthus, Cleisthanthus, Cleisthantus, Cleistopholis, Coccoloba, Cococeras, Cocoseras, Cola, Conceveiba, Coona, Copaifera, Cordia, Corynanthe, Corythophora, Couepia, Couma, Couratari, Coussarea, Cratoxylum, Croton, Crudia, Crypteronia, Cryptocarya, Cupania, Cussonia, Cuviera, Cyathocalyx, Cybianthus, Cynometra, Cyrillopsis, Dacryodes, Dalbergia, Daniellia, Dehaasia, Dendrobangia, Desplatsia, Detarium, Dialium, Dichapetalum, Dicorynia, Dictyandra, Didymopanax, Dillenia, Dimocarpus, Diopyros, Diospyros, Diplotropis, Dipterocapus, Dipterocarpus, Dipteryx, Discoglypremna, Discophora, Disoxylum, Distemonanthus, Dracaena, Drypetes, Duboscia, Duguetia, Dulacia, Durio, Duriocarinatus, Duroia, Dyera, Dysoxylum, Ecclinusa, Ehretia, Ekebergia, Elaeis, Elaeocarpus, Elaeoluma, Elaeophorbia, Elaiocarpus, Elizabetha, Elvasia, Emmotum, Endiandra, Endlicheria, Entandrophragma, Enterolobium, Eperua, Ephedranthus, Eribroma, Eriotheca, Erisma, Erycibe, Erythrina, Erythroxylum, Eschweilera, Eugeinsonia, Eugeisonia, Eugeissonia, Eugenia, Euonymus, Euplassa, Euterpe, Exellodendron, Fagara, Faramea, Ferdinandusa, Ficus, Flacourtia, Funtumia, Fusaea, Garcinia, Gardenia, Gaulettia, Geissospermum, Geonoma, Gironiera, Girroniera, Glochidion, Gluta, Glycosmis, Glycydendron, Glyphaea, Gmelina, Gnetum, Gonystylus, Gordonia, Goupia, Grewia, Guapira, Guarea, Guatteria, Guibourtia, Gustavia, Gymnacranthera, Gymnostemon, Handroanthus, Harpullia, Hasseltia, Hebepetalum, Heisteria, Helicia, Helicostylis, Henriettea, Heritiera, Herritiera, Hevea, Hexalobus, Heynea, Hidnocarpus, Hieronima, Hieronyma, Hildegardia, Himatanthus, Hirtella, Holarrhena, Holigarna, Holoptelea, Homalium, Homalolepis, Hopea, Horsfieldia, Hortia, Humboldtia, Humiria, Humiriastrum, Hydnocarpus, Hydocarpus, Hydrochorea, Hymenaea, Hymenolobium, Hymenopus, Hymenostegia, Ilex, Indet., Indet.Anacardiaceae, Indet.Annonaceae, Indet.Apocynaceae, Indet.Arecaceae, Indet.Bignoniaceae, Indet.Burseraceae, Indet.Capparaceae, Indet.Chrysobalanaceae, Indet.Clusiaceae, Indet.Combretaceae, Indet.Dichapetalaceae, Indet.Euphorbiaceae, Indet.Fabaceae, Indet.FabaceaeCaesalpinioideae(mimosoid_clade), Indet.FabaceaePapilionoideae, Indet.Humiriaceae, Indet.Indet., Indet.Lamiaceae, Indet.Lauraceae, Indet.Lecythidaceae, Indet.Malvaceae, Indet.MalvaceaeBombacoideae, Indet.Melastomataceae, Indet.Moraceae, Indet.Myrtaceae, Indet.Nyctaginaceae, Indet.Olacaceae, Indet.Rubiaceae, Indet.Salicaceae, Indet.Sapindaceae, Indet.Sapotaceae, Indet.Urticaceae, Indet.Violaceae, Indet.Vochysiaceae, Inga, Inhambanella, Irvingia, Iryanthera, Isertia, Isolona, Isonandra, Ixonanthes, Ixora, Jacaranda, Jacaratia, Jackia, Keayodendron, Khaya, Kigelia, Klainedoxa, Knema, Koodersiodendron, Koompasia, Koona, Koordersiodendron, Kubitzkia, Kutchubaea, Lacistema, Lacmellea, Lacunaria, Laetia, Lannea, Lasiodiscus, Lecythis, Leonia, Leptaulus, Leptobalanus, Licania, Licaria, Licuala, Limadendron, Lithocarpus, Litsea, Livistona, Lophopetalum, Loreya, Lovoa, Loxopterygium, Luehea, Lueheopsis, Lythocarpus, Mabea, Macaranga, Maccaranga, Machilus, Macoubea, Macrolobium, Madhuca, Maesobotrya, Mahurea, Majidea, Mallotus, Malouetia, Malpighia, Mangifera, Manilkara, Mansonia, Maprounea, Maquira, Maranthes, Mareya, Margaritaria, Martiodendron, Massularia, Mastixia, Matayba, Matisia, Maytenus, Melanochyla, Melicoccus, Melicope, Meliosma, Memecylon, Mesua, Mezilaurus, Mezzetia, Miconia, Microcos, Microdesmis, Micropholis, Microtropis, Milicia, Millettia, Minquartia, Monodora, Monoon, Monteverdia, Morelia, Moronobea, Morus, Moultonianthus, Mouriri, Moutabea, Myrcia, Myrciaria, Myrianthus, Myristica, Napoleona, Naringi, Nauclea, Naucleopsis, Neea, Neesia, Neocalyptrocalyx, Neonauclea, Neoscortechinia, Nepheium, Nephelium, Nesogordonia, Newbouldia, Nothopegia, Ochanostachys, Ochthocosmus, Ocotea, Oenocarpus, Okoubaka, Olax, Oldfieldia, Ongokea, Ormosia, Orophea, Osteophloeum, Ostodes, Otonephelium, Ouratea, Oxandra, Pachira, Pachystela, Pajanelia, Palaqium, Palaquium, Palicourea, Paracroton, Parahancornia, Paramachaerium, Parashorea, Parastemon, Parinari, Parinariopsis, Parishia, Parkia, Payena, Paypayrola, Peltogyne, Pentace, Pera, Perebea, Phyllanthus, Picralima, Pimeleodendron, Piptadeniastrum, Placodiscus, Planchonia, Platonia, Platymiscium, Plectronia, Podocarpus, Pogonophora, Polyalthia, Polyalthiya, Polyanthia, Polyosma, Pometia, Popowia, Poraqueiba, Posoqueria, Pourouma, Pouteria, Pradosia, Prioria, Protium, Prunus, Pseudolmedia, Pseudopiptadenia, Pseudospondias, Pseudoxandra, Psidium, Psychotria, Psydrax, Pternandra, Pterocarpus, Pterocymbium, Pterospermum, Pterygota, Ptychopetalum, Ptychophyxys, Pycnanthus, Qualea, Quercus, Quiina, Rauvolfia, Recordoxylon, Reinwardtiodendron, Rhabdodendron, Rheedia, Rhodamnia, Rhodostemonodaphne, Richeria, Ricinodendron, Rinorea, Rothmannia, Roucheria, Roupala, Ruizterania, Ryparosa, Sacoglottis, Sageraea, Sagotia, Sandwithia, Santiria, Sapium, Saraca, Sarcotheca, Scaphium, Schefflera, Schleichera, Sclerolobium, Scottellia, Semecarpus, Sextonia, Shirakiopsis, Shorea, Simaba, Simarouba, Sindora, Siparuna, Sizygium, Sloanea, Socratea, Soyauxia, Spathodea, Spatholobus, Spondias, Stachyarrhena, Stemonurus, Sterculia, Stereospermum, Strombosia, Strychnos, Stryphnodendron, Styrax, Swartzia, Swintonia, Symphonia, Symplocos, Syzigium, Syzygium, Tabebuia, Tabernaemontana, Tachigali, Talisia, Tapirira, Tapura, Teclea, Teijmaniodendron, Teijsmaniodendron, Terminalia, Ternstroemia, Tetragastris, Tetrameranthus, Tetramerista, Tetrapilus, Tetrapleura, Teysmaniodendron, Theobroma, Thyrsodium, Timonius, Toona, Toulicia, Touroulia, Tovomita, Trattinnickia, Treculia, Trema, Trichilia, Trilepisium, Triplochiton, Tristania, Tritaxis, Trymatococcus, Turpinia, Unonopsis, Vantanea, Vatairea, Vataireopsis, Vateria, Vatica, Vepris, Vernonia, Virola, Vismia, Vitex, Vochysia, Votomita, Vouacapoua, Vouarana, Xanthophyllum, Xylopia, Xylosma, Zanthoxylum, Zygia\"\n\n\nWith the following counts:\n\n\nCode\ntaxo %&gt;%\n  select(genus) %&gt;%\n  unique() %&gt;%\n  summarise(\n    \"Missing\" = sum((genus %in% c(\"#N/A\", \"Indet.\")),\n      na.omit = TRUE\n    ),\n    \"Family-only\" = sum(grepl(\"Indet.\", genus), na.omit = TRUE)\n  ) %&gt;%\n  gather(\"type\", \"number\") %&gt;%\n  kable(caption = \"Number of genus by issue type.\")\n\n\n\nNumber of genus by issue type.\n\n\ntype\nnumber\n\n\n\n\nMissing\n3\n\n\nFamily-only\n36"
  },
  {
    "objectID": "11_raw.html#species",
    "href": "11_raw.html#species",
    "title": "Raw",
    "section": "Species",
    "text": "Species\nSpecies includes the following dubious names:\n\nUnidentified (“det”, “^sp”). Indet., sp, sp., Schaeff.\nSub-taxonomic (“[[:punct:]]”): guyanensis subsp. Guyanensis, acuminatum_subsp.juniperinum, cuspidata_subsp.dura, guyanensis subsp. Guyanensis, guyanensis_subsp.duckeana, opacum_subsp.rabelianum, panacoco_var.panacoco, persistens_subsp.aurantiaca, tomentosa_subsp.maroniensis, venosa_subsp.amazonica, vera_subsp.affinis\nUndescribed (“^sp”). sp.1, sp.1-CAY, sp.10-CAY, sp.11-CAY, sp.12-CAY, sp.13-CAY, sp.14-CAY, sp.15-CAY, sp.16-CAY, sp.17-CAY, sp.18-CAY, sp.1Guyafor, sp.2, sp.2-CAY, sp.21_DS, sp.22-CAY, sp.23-CAY, sp.24-CAY, sp.2BAF, sp.2Guyafor, sp.3, sp.3-CAY, sp.30-CAY, sp.33-CAY, sp.34-CAY, sp.35-CAY, sp.35Guyafor, sp.36-CAY, sp.38Guyafor, sp.3BAF, sp.3Guyafor, sp.4-CAY, sp.42-CAY, sp.5-CAY, sp.5Guyafor, sp.6-CAY, sp.6Guyafor, sp.7-CAY, sp.70-CAY, sp.71-CAY, sp.7Guyafor, sp.8-CAY, sp.9-CAY, sp.B1, sp.B10, sp.B2, sp.B35, sp.B5, sp.B8, sp.B9, sp.C, sp.D, sp.FG13-Holst, sp.FG14-Holst, sp.FG2-Holst, sp.FG21-Holst, sp.FG9-Holst, sp.P1, sp.P11, sp.P22, sp.P3, sp.P33, sp.P4, sp.P6, sp.P9\n\nSee the list below:\n\n\nCode\nt &lt;- select(taxo, species) %&gt;%\n  unique() %&gt;%\n  filter(grepl(\"^sp\", species))\nunique(taxo$species) %&gt;%\n  sort() %&gt;%\n  paste0(collapse = \", \")\n\n\n[1] \"abyssinica, acida, acreana, acrocephala, aculeata, acuminata, acuminatissima, acuminatissimum, acuminatum_subsp.juniperinum, acuminta, acutiflora, acutifolium, adianthifolia, adolphi-fridericii, aerugo, africana, africanum, africanus, afzelii, agami, agamii, aggregatum, alata, alba, albescens, albicans, albicoria, albiflora, albiflorum, album, alchorneoides, alpinus, alternifolia, altisima, altissima, altissimum, altsonii, amara, amazonia, amazonica, amazonicum, amazonicus, ambelaniifolia, ambotay, amentacea, americana, amoenum, amshoffiana, amythiesii, anamalaiense, anastomosans, aneura, angolense, angolensis, angulata, angustifolius, angustiloba, aningeri, anisophylla, anisophyllus, anomala, antennifera, anteridifera, anthotheca, anysophyllus, apetala, apiculatum, aquatica, aracouchini, arborea, arborescens, arboreus, argenteum, arguta, argyrophylla, aristata, arnoldiana, arnottiana, aromatica, articulatus, asbeckii, aspera, assamicus, attenuata, aubletii, aubrevillei, augusta, auriculata, aviformis, aylmeri, bacaba, bacciformis, baculifera, balsamifera, bancoensis, bangii, bankae, bankense, barbatum, barteri, bataua, becarii, beccariana, beccarii, beccarina, beddomei, bella, bellirica, benetii, bengalensis, bennetii, benthamiana, benthamianus, benthamii, bethanniana, bicolor, bicornis, bidentata, bifolium, bigeminum, bilocularis, blumeanus, bolivarensis, boliviana, boonei, borneensis, Borneensis, bourdillonii, bourgoni, boya, brachiata, brachyata, brachybotrys, brachypetala, brachystachys, brachytepala, bracteata, bracteatus, bracteosa, brasiliense, brasiliensis, brevibracteatus, brevipes, brevis, brevistaminea, bridelioides, brunnescens, brunonis, buonopozense, burserifolia, buxifolia, cacao, caerulescens, caimito, cainito, caloneura, calophylla, calophyllum, calycina, campanulata, campestris, canaliculata, canarica, candollei, canescens, cannella, cantleyanus, capensis, capitata, capitatus, capitulifera, capreifolia, carbonaria, cardiosperma, caricifolia, carinata, carinatus, carrinatus, carthagenensis, caryophylloides, castanea, castaneifolia, cateniformis, caudata, caudatum, cavalcantei, cayennensis, ceanothifolia, cedrata, cedron, ceratoxylon, cernua, ceylanica, chartacea, chartaceifolia, chevalieri, chloranthum, chlorantum, chrysochlamys, chrysophylla, chrysophyllum, cicatricata, ciliata, cinerea, citrifolia, citrifolium, cladantha, clathrata, claviflora, coarctata, coccinea, cochinchinensis, cochlariflorum, cochlearia, coerulea, coffeifolia, coffeoides, cognatum, collina, collocarpa, compressa, conferta, confertiflora, confertus, congesta, congestiflora, conocarpus, contracta, copaia, cordata, cordatum, cordifolia, coriacea, cornutus, corrugata, corymbosa, costata, costulata, courbaril, courtallensis, coutinhoi, cowanii, crassa, crassifolia, crassipetalum, crenata, crenulata, crinita, crispiflorus, cristata, cruentum, cumini, cuneata, cuneatum, cuneifolium, cupulata, cuspidata, cuspidata_subsp.dura, cydonioides, cylindrica, cylindricum, cymosa, daphnoides, dasyphyllum, debilis, decagyna, decandra, decandrum, decaphylla, decaphyllus, decipiens, decolorans, decorticans, decussata, deflexa, demerarae, demerarense, densa, densicoma, densiflora, densifolia, densifrons, dentata, denticulatum, desmanthum, dichotoma, dichroa, diderrichii, dinizii, dinklagei, dioica, dioicus, discoidea, discolor, discreta, divaricatum, divergen, divergens, diversifolia, diversifolium, dolichocalyx, dolichocarpa, dryobalanoides, duckeana, duckei, dulcis, dumetosa, durifructum, durlandii, ebenum, echinocarpa, edentula, edertii, edule, edulis, effusus, egensis, eggersiana, egregia, ehie, eichleri, ekmanii, elastica, elasticus, elliptica, ellipticifolia, ellipticum, elvasioides, engleri, erectinervia, eriobetalum, eriopila, erythrocarpa, eugeniifolia, euneura, ewickii, ewyckii, exaltata, exasperata, excelliptica, excelsa, excelsum, excimia, exelliptica, exelsa, exorrhiza, exsucca, fagifolium, falcata, falcifera, fallax, fallx, fanchoniana, fanshawei, fasciculata, fastigiata, fauciflora, ferok, ferox, ferrea, ferruginea, ficigemma, filipes, fimbriata, firma, flava, flavescens, flavicans, flavilatex, flavum, floribunda, foetida, forbesii, formosum, forstenii, fosteri, fragrans, fraxinifolius, frondosa, frondosum, frutescens, fruticosa, furfuracea, gabonensis, galeata, gallicum, gamofetala, gamopetala, ganggo, garckeana, gardneri, gazelii, genipiflora, ghatensis, gigantea, giganteum, gilgiana, gilletii, glaberrima, glabra, glabrata, glabriflorus, glabrum, glandistipula, glandulifera, glandulosa, glandulosum, glauca, glaucescens, glaucus, globosa, globulifera, glomerata, gloriosa, glycycarpa, goetheanus, goliath, gomma, gomphophylla, gonggrijpii, gongrijpii, gore, graciliflora, gracilifolia, gracilis, grahamii, grandiflora, grandiflorus, grandifolia, grandifoliola, grandifolium, grandifolius, grandis, granulosa, granvillei, graveolens, griffithi, griffithii, grifithii, grossularioides, guatterioides, guereensis, guianense, guianensis, guidonia, guineense, guineensis, gummi-gutta, gutta, guyanensis, guyanensis subsp. Guyanensis, guyanensis_subsp.duckeana, habrantha, harmsiana, havilandii, helstonei, hemidasya, hemisphericum, heptaphyllum, heteromorphus, heterophyllus, heudelotii, hexandrum, hexapetala, hexaphylla, hirsuta, hirsutus, hispida, hispidula, holcogyne, hosei, hostmanniana, hostmannii, huberi, hulletii, hullettii, humeratus, humiriifolium, hypoglauca, hypoleuca, hypophoenica, hypophoenicea, idatimon, inconspicua, incurvata, Indet., indica, indicus, indum, inelegans, inermis, iners, inpressa, insignis, integer, integra, integrifolia, intermedia, inundata, ivorensis, Jambolides, jamboloides, jariensis, javanica, javitensis, jenmanii, johorensis, jupunba, kamerunensis, kappleri, keayana, keithii, kemando, kikir, kingii, klaineana, klainei, kunstleri, kunstlerii, kunthiana, kuteyensis, kwatae, laetum, laeve, laevifolim, laevifrons, laevigata, laevigatus, laevis, lambertiana, lanceaefolia, lanceaefoliia, lanceifolius, lanceolata, lanceolatus, lancifolia, lapaceum, lappaceum, latericia, lateriflora, lateritia, latifolia, latistipulus, laurina, laxiflora, lecointei, leembruggianus, leiocalycina, leiocarpa, leonensis, lepidota, lepidotula, leprieurii, leprosula, letestui, licaniiflora, ligustrinum, lisae, litorale, littorale, lomatophylla, longan, longiflora, longifolia, longifolium, longipedicellata, longipedunculata, longipetiolata, longistylus, longitubulosa, loubryana, lowii, lucidus, lunata, lunu-ankenda, machadoana, macrocarpa, macrocarpum, macrophylla, macrophyllum, macrophyllus, macropodum, macroptera, macrosepala, madagascariense, madruno, magnifica, magnoliifolia, maingayi, maingayii, majuscula, mala-elengi, malabarica, malabaricum, malabaricus, malabathrum, malaccense, malaccensis, malayana, mannii, marcgravianum, marginata, maripa, maroniensis, marowynensis, martiniana, martinicensis, Mast, mataybifolia, matourensis, maxima, maxweliana, maxwelliama, maxwelliana, maxwilliana, megalantha, megalophylla, megantha, megaphylla, melanopoda, melinoniana, melinonii, membranacea, membranifolium, mensalis, mesozygia, mespiloides, mezii, michelii, micrantha, micraster, microbotrys, microcarpa, micropetalum, microphylla, mildbraedii, minor, minutiflora, modestum, modustum, mollis, mollissima, mombin, monadelpha, monbuttensis, montana, morella, morettii, morii, morototoni, moschata, motleyana, mucuso, multicostata, multiflora, multiovula, muricata, myrianthes, myrianthus, Myrianthus, myristica, myrranthus, myrsinoides, myrtifolia, nacropodum, neglecta, neriifolia, neriifolius, nervosa, nieuwenhuisii, nigra, nigrecens, nigritana, nitens, nitida, nitidissima, nobilis, nodosa, noronhoe, nouragensis, nux-vomica, nymphaeifolia, oblanceolata, oblonga, oblongata, oblongifolia, oblongum, obovata, obovatum, obscura, obtusa, obtusifolia, obtusifolium, occidentalis, ochneocarpa, ochracea, ochrocalyx, octandrus, odorata, odoratisima, odoratissima, odoratissimus, officinalis, ohracea, olacoides, oldemanii, oleosa, oleracea, oligandrus, oliveri, opaca, opacum_subsp.rabelianum, operculata, opposita, orellana, orientalis, orinocensis, ormosioides, ornata, ottolanderi, ovalifolia, ovalis, ovata, oviformis, oxleyanis, oxleyanus, pachyceras, pallidum, pallidus, paludosa, palustris, panacoco, panacoco_var.panacoco, panamensis, paniculata, panurensis, papaverifera, papaveroides, papaya, papilio, paraensis, paramaca, parillo, parinarioides, parviflora, parviflorum, parvifolia, Parvifolia, parvifoliolum, parvifructa, parvum, patens, patrisii, pauciflora, pectinosquamata, pedicellaris, pedicellata, pedunculata, peltata, pendula, pendulla, pendulus, pentagyna, pentandra, pentandrum, pentandrus, percurrens, perpulchrum, perrottetii, persistens, persistens_subsp.aurantiaca, perviridis, pescotomentosa, petalanthera, petidaris, petiolaris, petiolatus, petoumo, petraeum, pezizifera, phaeophylla, philippensis, philippinensis, pilosula, pinanga, pinnata, pinnatum, piresiana, piriri, pisocarpa, pitumba, plagiocarpium, platycephalum, platyphylla, platyspermum, platythyrsa, plukenetii, poeppigiana, poeppigii, poiteaui, polita, polyanthum, polybotryum, polycarpa, polyphylla, polystachys, polystachyum, pomiferum, ponga, praealta, praeclara, prasina, prieuriana, prieurii, procera, prouacensis, pruinosa, pruriens, pseudolancium, pseudopsidium, psilostachya, pterocarpoides, ptychandra, puberula, puberulum, pubescens, pubiflora, pulchella, pulcher, pulcherianum, pulcherrianum, pulcherrima, pulcherrimum, pulcherrinum, pulvinata, pulvinervis, punctata, punctulata, purpurascens, purpurea, pustulata, pyrifolium, quadrifida, quadrijuga, quintasii, racemosa, ramiflora, ramuliflora, rasak, rassak, recurvata, remiger, reticulata, retinervis, revolutus, rhetsa, rhinopetala, rhoifolia, richardiana, rimosa, robusta, robustum, rodolphii, rodriguesiana, rodriguesii, rogosa, rohrii, rosea, rosodora, rostrata, rostratum, roxburghii, rubescens, rubiginosa, rubiginosum, rubra, rufescens, rufovirgata, rugosa, rumphii, rupicola, sagotiana, sagotianum, sagotii, salikounda, sandwithianum, sanguinolentum, santalinoides, sapida, sarmentosa, scabra, Schaeff., scholaris, schomburgkiana, schomburgkianus, schomburgkii, sciadophylla, sciophilum, sclerophylla, scleroxylon, scrobiculata, sebifera, seminis, senegalense, senegalensis, septentrionalis, sericea, sericeum, serrata, serratifolia, serratifolius, serratus, sertulifera, sessilifolia, silvatica, simaboides, simiorum, simplicifolia, simplicifolium, sinemariensis, singularis, sissoides, smithiesii, smyethiesi, smyetiesii, smythiesii, Smythiesii, soulatri, sp, sp., sp.1, sp.1-CAY, sp.10-CAY, sp.11-CAY, sp.12-CAY, sp.13-CAY, sp.14-CAY, sp.15-CAY, sp.16-CAY, sp.17-CAY, sp.18-CAY, sp.1Guyafor, sp.2, sp.2-CAY, sp.21_DS, sp.22-CAY, sp.23-CAY, sp.24-CAY, sp.2BAF, sp.2Guyafor, sp.3, sp.3-CAY, sp.30-CAY, sp.33-CAY, sp.34-CAY, sp.35-CAY, sp.35Guyafor, sp.36-CAY, sp.38Guyafor, sp.3BAF, sp.3Guyafor, sp.4-CAY, sp.42-CAY, sp.5-CAY, sp.5Guyafor, sp.6-CAY, sp.6Guyafor, sp.7-CAY, sp.70-CAY, sp.71-CAY, sp.7Guyafor, sp.8-CAY, sp.9-CAY, sp.B1, sp.B10, sp.B2, sp.B35, sp.B5, sp.B8, sp.B9, sp.C, sp.D, sp.FG13-Holst, sp.FG14-Holst, sp.FG2-Holst, sp.FG21-Holst, sp.FG9-Holst, sp.P1, sp.P11, sp.P22, sp.P3, sp.P33, sp.P4, sp.P6, sp.P9, speciosa, speciosum, spinosa, splendens, spruceana, spruceanum, sprucei, squamata, squarrosa, stellatus, stenodictya, stevensonii, stipulaceum, stipularis, strictum, strumosum, suaveolens, subcrenatum, subdimidiata, subdita, subericarpa, subglandulosa, subglauca, subobovatum, subscorpioidea, subsericea, subserratum, subterminalis, succosa, sumatrana, sumatranum, sundaicus, superba, surinamense, surinamensis, swintoioides, swintonioides, sylvatica, sylvestris, synandra, tabularis, tadulingamii, talbotii, tamaquarina, taubertiana, tawahense, tenuifolia, tenuifolium, terminalis, tessmannii, testudinarum, tetragona, tetramera, tetraphylla, tetraptera, thibaudiana, thompsonii, thurifera, tiliifolia, tomentella, tomentosa, tomentosa_subsp.maroniensis, toqueve, torta, toxicaria, trachyphylla, tragacantha, travancorica, trichilioides, trichotoma, tricolor, triflora, trifoliatum, trifoliolatum, trijuga, trinervia, triplinervia, tristis, tschudyoides, tubifera, tubulatum, tungurut, turbinata, ulceolaris, ulei, ulmifolia, umbellata, umbellifera, umbonata, umbonta, uncinatum, undulata, uniflora, unijugata, urceolaris, urceolata, urens, urophyllus, utile, valida, variabilis, variifolia, velutina, velutinum, venosa, venosa_subsp.amazonica, venulosa, venulosum, venusta, vera_subsp.affinis, verdoorniana, vernicosa, vignei, villifera, villosa, vilosa, vinosa, virgultosa, viridicans, viridiflora, vittelinum, vogelii, vomitoria, wachenheimii, walichii, wallichiana, wallichii, welwitschii, whiteana, wightiana, wightianum, wightii, williamsii, woodi, woodii, wullschlaegeliana, zabucajo, zaizou, zanthoxyloides, zechiana, zenkeri, zeylanicum, zeylanicus, zygia\"\n\n\n\n\nCode\nunid &lt;- c(\"Indet.\", \"sp\", \"sp.\", \"Schaeff.\")\nsubtaxo &lt;- c(\n  \"guyanensis subsp. Guyanensis\", \"acuminatum_subsp.juniperinum\",\n  \"cuspidata_subsp.dura\", \"guyanensis subsp. Guyanensis\",\n  \"guyanensis_subsp.duckeana\", \"opacum_subsp.rabelianum\",\n  \"panacoco_var.panacoco\", \"persistens_subsp.aurantiaca\",\n  \"tomentosa_subsp.maroniensis\", \"venosa_subsp.amazonica\",\n  \"vera_subsp.affinis\"\n)\nundesc &lt;- c(\n  \"sp.1\", \"sp.1-CAY\", \"sp.10-CAY\", \"sp.11-CAY\", \"sp.12-CAY\",\n  \"sp.13-CAY\", \"sp.14-CAY\", \"sp.15-CAY\", \"sp.16-CAY\",\n  \"sp.17-CAY\", \"sp.18-CAY\", \"sp.1Guyafor\", \"sp.2\", \"sp.2-CAY\",\n  \"sp.21_DS\", \"sp.22-CAY\", \"sp.23-CAY\", \"sp.24-CAY\", \"sp.2BAF\",\n  \"sp.2Guyafor\", \"sp.3\", \"sp.3-CAY\", \"sp.30-CAY\", \"sp.33-CAY\",\n  \"sp.34-CAY\", \"sp.35-CAY\", \"sp.35Guyafor\", \"sp.36-CAY\",\n  \"sp.38Guyafor\", \"sp.3BAF\", \"sp.3Guyafor\", \"sp.4-CAY\",\n  \"sp.42-CAY\", \"sp.5-CAY\", \"sp.5Guyafor\", \"sp.6-CAY\", \"sp.6Guyafor\",\n  \"sp.7-CAY\", \"sp.70-CAY\", \"sp.71-CAY\", \"sp.7Guyafor\", \"sp.8-CAY\",\n  \"sp.9-CAY\", \"sp.B1\", \"sp.B10\", \"sp.B2\", \"sp.B35\", \"sp.B5\", \"sp.B8\",\n  \"sp.B9\", \"sp.C\", \"sp.D\", \"sp.FG13-Holst\", \"sp.FG14-Holst\",\n  \"sp.FG2-Holst\", \"sp.FG21-Holst\", \"sp.FG9-Holst\", \"sp.P1\", \"sp.P11\",\n  \"sp.P22\", \"sp.P3\", \"sp.P33\", \"sp.P4\", \"sp.P6\", \"sp.P9\"\n)\ntaxo %&gt;%\n  select(species) %&gt;%\n  unique() %&gt;%\n  summarise(\n    \"Unidentified\" = sum(species %in% unid,\n      na.omit = TRUE\n    ),\n    \"Sub-taxonomic\" = sum(species %in% subtaxo,\n      na.omit = TRUE\n    ),\n    \"Undescribed\" = sum(species %in% undesc,\n      na.omit = TRUE\n    )\n  ) %&gt;%\n  gather(\"type\", \"number\") %&gt;%\n  kable(caption = \"Number of species by issue type.\")\n\n\n\nNumber of species by issue type.\n\n\ntype\nnumber\n\n\n\n\nUnidentified\n5\n\n\nSub-taxonomic\n11\n\n\nUndescribed\n66"
  },
  {
    "objectID": "12_cleaned.html#names-corrections",
    "href": "12_cleaned.html#names-corrections",
    "title": "Cleaning",
    "section": "Names corrections",
    "text": "Names corrections\nFirst we cleaned family, genus and species names using contingency table built on the information of dubious names from the previous chapter. We obtained 1,032 corrections in total.\n\n\nCode\nfamily_tab &lt;- data.frame(\n  family_corrected = NA,\n  family = c(\"Indet.\", \"Not in DB\", \"unid.\", \"unidentified\", \"#N/A\", \"+\"),\n  family_reason = c(\n    rep(\"missing\", 2),\n    rep(\"family-only\", 4)\n  )\n)\nwrite_tsv(family_tab, \"outputs/family_correction_table.tsv\")\ngenus_tab &lt;- data.frame(\n  genus_corrected = NA,\n  genus = c(\n    \" #N/A\", \"Indet.\", \"Indet.Apocynaceae\", \"Indet.Arecaceae\",\n    \"Indet.Bignoniaceae\", \"Indet.Burseraceae\",\n    \"Indet.Capparaceae\", \"Indet.Chrysobalanaceae\", \"Indet.Clusiaceae\",\n    \"Indet.Combretaceae\", \"Indet.Dichapetalaceae\", \"Indet.Euphorbiaceae\",\n    \"Indet.Fabaceae\", \"Indet.FabaceaeCaesalpinioideae(mimosoid_clade)\",\n    \"Indet.FabaceaePapilionoideae\", \"Indet.Humiriaceae\", \"Indet.Indet.\",\n    \"Indet.Lamiaceae\", \"Indet.Lauraceae\", \"Indet.Lecythidaceae\",\n    \"Indet.Malvaceae\", \"Indet.MalvaceaeBombacoideae\",\n    \"Indet.Melastomataceae\", \"Indet.Moraceae\", \"Indet.Myrtaceae\",\n    \"Indet.Nyctaginaceae\", \"Indet.Olacaceae\", \"Indet.Rubiaceae\",\n    \"Indet.Salicaceae\", \"Indet.Sapindaceae\", \"Indet.Sapotaceae\",\n    \"Indet.Urticaceae\", \"Indet.Violaceae\", \"Indet.Vochysiaceae\"\n  ),\n  genus_reason = c(\n    rep(\"unidentified\", 1),\n    rep(\"missing\", 1),\n    rep(\"family-only\", 32)\n  )\n)\nwrite_tsv(genus_tab, \"outputs/genus_correction_table.tsv\")\nspecies_tab1 &lt;- data.frame(\n  species_corrected = NA,\n  species = c(\n    \"Indet.\", \"sp\", \"sp.\", \"Schaeff.\",\n    \"sp.1\", \"sp.1-CAY\", \"sp.10-CAY\", \"sp.11-CAY\", \"sp.12-CAY\",\n    \"sp.13-CAY\", \"sp.14-CAY\", \"sp.15-CAY\", \"sp.16-CAY\",\n    \"sp.17-CAY\", \"sp.18-CAY\", \"sp.1Guyafor\", \"sp.2\", \"sp.2-CAY\",\n    \"sp.21_DS\", \"sp.22-CAY\", \"sp.23-CAY\", \"sp.24-CAY\", \"sp.2BAF\",\n    \"sp.2Guyafor\", \"sp.3\", \"sp.3-CAY\", \"sp.30-CAY\", \"sp.33-CAY\",\n    \"sp.34-CAY\", \"sp.35-CAY\", \"sp.35Guyafor\", \"sp.36-CAY\",\n    \"sp.38Guyafor\", \"sp.3BAF\", \"sp.3Guyafor\", \"sp.4-CAY\",\n    \"sp.42-CAY\", \"sp.5-CAY\", \"sp.5Guyafor\", \"sp.6-CAY\", \"sp.6Guyafor\",\n    \"sp.7-CAY\", \"sp.70-CAY\", \"sp.71-CAY\", \"sp.7Guyafor\", \"sp.8-CAY\",\n    \"sp.9-CAY\", \"sp.B1\", \"sp.B10\", \"sp.B2\", \"sp.B35\", \"sp.B5\", \"sp.B8\",\n    \"sp.B9\", \"sp.C\", \"sp.D\", \"sp.FG13-Holst\", \"sp.FG14-Holst\",\n    \"sp.FG2-Holst\", \"sp.FG21-Holst\", \"sp.FG9-Holst\", \"sp.P1\", \"sp.P11\",\n    \"sp.P22\", \"sp.P3\", \"sp.P33\", \"sp.P4\", \"sp.P6\", \"sp.P9\"\n  ),\n  species_reason = c(\n    rep(\"unidentified\", 4),\n    rep(\"undescribed\", 65)\n  )\n)\nspecies_tab2 &lt;- data.frame(\n  species_corrected = c(\n    \"guyanensis\", \"acuminatum\", \"cuspidata\", \"guyanensis\",\n    \"guyanensis\", \"opacum\", \"panacoco\", \"persistens\",\n    \"tomentosa\", \"venosa\", \"vera\"\n  ),\n  species = c(\n    \"guyanensis subsp. Guyanensis\", \"acuminatum_subsp.juniperinum\",\n    \"cuspidata_subsp.dura\", \"guyanensis subsp. Guyanensis\",\n    \"guyanensis_subsp.duckeana\", \"opacum_subsp.rabelianum\",\n    \"panacoco_var.panacoco\", \"persistens_subsp.aurantiaca\",\n    \"tomentosa_subsp.maroniensis\", \"venosa_subsp.amazonica\",\n    \"vera_subsp.affinis\"\n  ),\n  species_reason = \"sub-taxonomic \"\n)\nbind_rows(species_tab1, species_tab2) %&gt;%\n  write_tsv(\"outputs/species_correction_table.tsv\")\ncleaned &lt;- read_tsv(\"data/raw_data/raw_taxonomy.tsv\") %&gt;%\n  rename_all(tolower) %&gt;%\n  filter(!(site %in% c(\n    \"Kibale\", \"Lesong\", \"Moju\", \"Mbaiki\", \"Peteco\",\n    \"Misiones\", \"Ulu Muda\", \"Sg Lalang\"\n  ))) %&gt;%\n  left_join(read_tsv(\"outputs/family_correction_table.tsv\")) %&gt;%\n  mutate(family = ifelse(!is.na(family_reason), family_corrected, family)) %&gt;%\n  select(-family_corrected) %&gt;%\n  left_join(read_tsv(\"outputs/genus_correction_table.tsv\")) %&gt;%\n  mutate(genus = ifelse(!is.na(genus_reason), genus_corrected, genus)) %&gt;%\n  select(-genus_corrected) %&gt;%\n  left_join(read_tsv(\"outputs/species_correction_table.tsv\")) %&gt;%\n  mutate(species = ifelse(!is.na(species_reason),\n    species_corrected, species\n  )) %&gt;%\n  select(-species_corrected)\nwrite_tsv(cleaned, \"data/derived_data/taxonomy_names_corrected.tsv\")\n\n\n\n\nCode\nread_tsv(\"data/derived_data/taxonomy_names_corrected.tsv\") %&gt;%\n  select(family_reason, genus_reason, species_reason) %&gt;%\n  gather(\"level\", \"reason\") %&gt;%\n  na.omit() %&gt;%\n  group_by(level, reason) %&gt;%\n  summarise(corrections = n()) %&gt;%\n  kable(\n    format.args = list(big.mark = \",\"),\n    caption = \"Number of corrections per level and reason.\"\n  )\n\n\n\nNumber of corrections per level and reason.\n\n\nlevel\nreason\ncorrections\n\n\n\n\nfamily_reason\nfamily-only\n5\n\n\nfamily_reason\nmissing\n1,030\n\n\ngenus_reason\nfamily-only\n1,453\n\n\ngenus_reason\nmissing\n36\n\n\ngenus_reason\nunidentified\n2\n\n\nspecies_reason\nsub-taxonomic\n61\n\n\nspecies_reason\nundescribed\n223\n\n\nspecies_reason\nunidentified\n2,166"
  },
  {
    "objectID": "12_cleaned.html#world-flora-online-wfo",
    "href": "12_cleaned.html#world-flora-online-wfo",
    "title": "Cleaning",
    "section": "World Flora Online (WFO)",
    "text": "World Flora Online (WFO)\nWe used WorldFlora and fuzzyjoin for synonymy and misspelling corrections.\n\n\nCode\nlibrary(WorldFlora)\nlibrary(fuzzyjoin)\ntaxo &lt;- read_tsv(\"data/derived_data/taxonomy_names_corrected.tsv\") %&gt;%\n  filter(!is.na(species)) %&gt;%\n  transmute(scientificname = paste(genus, species)) %&gt;%\n  arrange(scientificname) %&gt;%\n  unique()\ncleaned &lt;- WFO.match.fuzzyjoin(\n  spec.data = taxo$scientificname,\n  WFO.file = \"data/raw_data/WFO_Backbone.zip\"\n)\nwrite_tsv(cleaned, \"outputs/wfo_out.tsv\")\n\n\n1525 species matched a species from the World Flora Online (WFO) except 4:\n\n\nCode\nwfo &lt;- read_tsv(\"outputs/wfo_out.tsv\")\nwfo %&gt;%\n  group_by(spec.name) %&gt;%\n  summarise(matched = all(Matched)) %&gt;%\n  group_by(matched) %&gt;%\n  summarise(N = n(), names = ifelse(!matched, paste(spec.name), \"\")) %&gt;%\n  unique() %&gt;%\n  kable(\n    format.args = list(big.mark = \",\"),\n    caption = \"Number of matched and unmatched species.\"\n  )\n\n\n\nNumber of matched and unmatched species.\n\n\nmatched\nN\nnames\n\n\n\n\nFALSE\n4\nAlseodaphne ceratoxylon\n\n\nFALSE\n4\nAlseodaphne havilandii\n\n\nFALSE\n4\nDuriocarinatus Mast\n\n\nFALSE\n4\nPalaquium cochlariflorum\n\n\nTRUE\n1,525\n\n\n\n\n\n\nAmong matched species, most were exact (not fuzzy misspelled species) and with a single match in WFO, still 113 had multiple matches and 159 were fuzzy misspelled species, both to investigate:\n\n\nCode\nwfo %&gt;%\n  filter(Matched) %&gt;%\n  group_by(spec.name) %&gt;%\n  summarise(fuzzy = all(Fuzzy), unique = all(Unique)) %&gt;%\n  group_by(fuzzy, unique) %&gt;%\n  summarise(N = n()) %&gt;%\n  mutate(\n    fuzzy = ifelse(fuzzy, \"fuzzy\", \"exact\"),\n    unique = ifelse(unique, \"unique\", \"multiple\")\n  ) %&gt;%\n  pivot_wider(names_from = \"unique\", values_from = \"N\") %&gt;%\n  kable(\n    format.args = list(big.mark = \",\"),\n    caption = \"Number of fuzzy and unique species.\"\n  )\n\n\n\nNumber of fuzzy and unique species.\n\n\nfuzzy\nmultiple\nunique\n\n\n\n\nexact\n103\n1,263\n\n\nfuzzy\n12\n147"
  },
  {
    "objectID": "12_cleaned.html#misspelling-fuzzy",
    "href": "12_cleaned.html#misspelling-fuzzy",
    "title": "Cleaning",
    "section": "Misspelling (fuzzy)",
    "text": "Misspelling (fuzzy)\nBy default WorldFlora limits fuzzy distance to 4, which seems more than acceptable and could be increased. Indeed one of the unmatched species, Palaquium cochlariflorum might be Palaquium cochleariifolium with a fuzzy distance of 6, but this can also be dealt with manually.\n\n\nCode\nwfo %&gt;%\n  filter(Matched, Fuzzy) %&gt;%\n  group_by(spec.name) %&gt;%\n  summarise(fuzzy_dist = unique(Fuzzy.dist)) %&gt;%\n  group_by(fuzzy_dist) %&gt;%\n  summarise(N = n()) %&gt;%\n  kable(caption = \"Number of misspelled species by the number of misspelled letters.\") # nolint\n\n\n\nNumber of misspelled species by the number of misspelled letters.\n\n\nfuzzy_dist\nN\n\n\n\n\n1\n99\n\n\n2\n38\n\n\n3\n15\n\n\n4\n7\n\n\n\n\n\nHowever, among the misspelled species with multiple matches, 4 have multiple newly accepted names:\n\n\nCode\nwfo %&gt;%\n  filter(Matched, Fuzzy, !Unique, New.accepted) %&gt;%\n  select(spec.name, scientificName) %&gt;%\n  unique() %&gt;%\n  group_by(spec.name) %&gt;%\n  filter(n() &gt; 1) %&gt;%\n  summarise(scientificName = paste0(scientificName, collapse = \", \")) %&gt;%\n  kable(caption = \"Fuzzy match with multiple newly accepted names.\")\n\n\n\nFuzzy match with multiple newly accepted names.\n\n\n\n\n\n\nspec.name\nscientificName\n\n\n\n\nAglaia cordifolia\nAcacia hastulata, Tilia platyphyllos subsp. cordifolia, Aglaia exstipulata, Aglaia elaeagnoidea, Macaranga cordifolia, Anemia phyllitidis, Jungermannia eucordifolia\n\n\nCocoseras borneensis\nThelypteris borneensis, Mallotus muticus\n\n\nMezzetia parvifolia\nCalea parvifolia, Distimake quinquefolius, Marcetia canescens\n\n\nShorea Parvifolia\nRubroshorea parvifolia, Rubroshorea ovata"
  },
  {
    "objectID": "12_cleaned.html#synonymy-multiple-matches",
    "href": "12_cleaned.html#synonymy-multiple-matches",
    "title": "Cleaning",
    "section": "Synonymy (multiple matches)",
    "text": "Synonymy (multiple matches)\nSimilarly, among the correctly spelled species with multiple matches, 6 have multiple newly accepted names:\n\n\nCode\nwfo %&gt;%\n  filter(Matched, !Fuzzy, !Unique, New.accepted) %&gt;%\n  select(spec.name, scientificName) %&gt;%\n  unique() %&gt;%\n  group_by(spec.name) %&gt;%\n  filter(n() &gt; 1) %&gt;%\n  summarise(scientificName = paste0(scientificName, collapse = \", \")) %&gt;%\n  kable(caption = \"Exact match with multiple newly accepted names.\")\n\n\n\nExact match with multiple newly accepted names.\n\n\n\n\n\n\nspec.name\nscientificName\n\n\n\n\nAglaia edulis\nAglaia samoensis, Aglaia saltatorum\n\n\nCallicarpa tomentosa\nCallicarpa kochiana var. kochiana, Callicarpa macrophylla, Callicarpa candicans var. candicans\n\n\nShorea leprosula\nRubroshorea leprosula, Rubroshorea platycarpa\n\n\nShorea parvifolia\nRubroshorea parvifolia, Rubroshorea ovata\n\n\nVernonia conferta\nPiptocarpha riedelii, Brenandendron donianum\n\n\nXylopia frutescens\nAnnona squamosa, Xylopia muricata"
  },
  {
    "objectID": "12_cleaned.html#synonymy-misspelling-corrections",
    "href": "12_cleaned.html#synonymy-misspelling-corrections",
    "title": "Cleaning",
    "section": "Synonymy & misspelling corrections",
    "text": "Synonymy & misspelling corrections\n\n⚠️ Multiple newly accepted names should be discussed.\n\nHowever, for the moment we will randomly select the first newly accepted name in this case. We will thus correct synonymy and misspelling by:\n\nUsing closest correct spelling\nAccepting single exact matches\nAccepting single newly accepted names for multiple matches\nAccepting the first newly accepted names for multiple matches in case of multiples (to be changed later)\n\n\n\nCode\ntaxo &lt;- read_tsv(\"data/derived_data/taxonomy_names_corrected.tsv\") %&gt;%\n  mutate(scientificname = paste(genus, species)) %&gt;%\n  arrange(site, scientificname) %&gt;%\n  unique()\nwfo &lt;- read_tsv(\"outputs/wfo_out.tsv\") %&gt;%\n  filter(Matched)\nwfo_exact &lt;- wfo %&gt;%\n  filter(Unique)\nwfo_mult &lt;- wfo %&gt;%\n  filter(!Unique) %&gt;%\n  group_by(spec.name) %&gt;%\n  filter(New.accepted) %&gt;%\n  sample_n(1)\nwfo_clean &lt;- bind_rows(wfo_exact, wfo_mult) %&gt;%\n  select(\n    spec.name, family, genus, specificEpithet,\n    scientificName\n  ) %&gt;%\n  rename(\n    scientificname = spec.name,\n    family_wfo = family,\n    genus_wfo = genus,\n    species_wfo = specificEpithet,\n    scientificname_wfo = scientificName\n  )\nwrite_tsv(wfo_clean, \"outputs/wfo_correction_table.tsv\")\nleft_join(taxo, wfo_clean) %&gt;%\n  write_tsv(\"data/derived_data/taxonomy_names_cleaned.tsv\")\n\n\n\n\nCode\nclean &lt;- read_tsv(\"data/derived_data/taxonomy_names_cleaned.tsv\")\nfam_cor &lt;- select(clean, family, family_wfo) %&gt;%\n  unique() %&gt;%\n  na.omit() %&gt;%\n  filter(family != family_wfo)\ngen_cor &lt;- select(clean, genus, genus_wfo) %&gt;%\n  unique() %&gt;%\n  na.omit() %&gt;%\n  filter(genus != genus_wfo)\nsp_cor &lt;- select(clean, species, species_wfo) %&gt;%\n  unique() %&gt;%\n  na.omit() %&gt;%\n  filter(species != species_wfo)\ndata.frame(\n  level = c(\"family\", \"genus\", \"species\"),\n  N = c(nrow(fam_cor), nrow(gen_cor), nrow(sp_cor))\n) %&gt;%\n  kable(caption = \"Number of synonymy, misspelling, and update corrections per taxonomic level\") # nolint\n\n\n\nNumber of synonymy, misspelling, and update corrections per taxonomic level\n\n\nlevel\nN\n\n\n\n\nfamily\n63\n\n\ngenus\n109\n\n\nspecies\n240"
  },
  {
    "objectID": "13_phylogeny.html",
    "href": "13_phylogeny.html",
    "title": "Phylogeny",
    "section": "",
    "text": "We used cleaned taxonomy to build a global phylogeny using V.PhyloMaker. This corresponds to version 1.\n\n\nCode\nlibrary(V.PhyloMaker)\nlibrary(ape)\nsplist &lt;- read_tsv(\"data/derived_data/taxonomy_names_cleaned.tsv\") %&gt;%\n  select(species_wfo, genus_wfo, family_wfo) %&gt;%\n  na.omit() %&gt;%\n  unique() %&gt;%\n  rename_all(~ gsub(\"_wfo\", \"\", .)) %&gt;%\n  mutate(species = paste(genus, species))\ntree &lt;- phylo.maker(\n  sp.list = splist,\n  tree = GBOTB.extended,\n  nodes = nodes.info.1,\n  scenarios = \"S3\"\n)\nwrite.tree(tree$scenario.3, \"outputs/phylogeny_full.tree\")\n\n\nWe can see the results with all families (a better representation might be found):\n\n\nCode\nsplist &lt;- read_tsv(\"data/derived_data/taxonomy_names_cleaned.tsv\") %&gt;%\n  select(species_wfo, genus_wfo, family_wfo) %&gt;%\n  na.omit() %&gt;%\n  unique() %&gt;%\n  rename_all(~ gsub(\"_wfo\", \"\", .)) %&gt;%\n  mutate(species = paste(genus, species))\nphylo &lt;- ape::read.tree(\"outputs/phylogeny_full.tree\")\nphylo_df &lt;- phylo4d(\n  phylo,\n  data.frame(species = gsub(\"_\", \" \", phylo$tip.label)) %&gt;%\n    left_join(splist)\n)\nggtree(phylo_df, aes(col = family), layout = \"circular\") +\n  theme_tree(legend.text = element_text(face = \"italic\", size = 6)) +\n  scale_color_discrete(\"\")\n\n\n\n\n\nAnd we can further explore the phylogeny per plot compared to the global phylogeny:\n\n\nCode\nphylo_site &lt;- function(sit) {\n  taxo &lt;- read_tsv(\"data/derived_data/taxonomy_names_cleaned.tsv\") %&gt;%\n    filter(site == sit) %&gt;%\n    select(species_wfo, genus_wfo, family_wfo) %&gt;%\n    na.omit() %&gt;%\n    unique() %&gt;%\n    rename_all(~ gsub(\"_wfo\", \"\", .)) %&gt;%\n    mutate(species = paste(genus, species))\n  phylo_df@data$site &lt;- phylo_df@data$species %in% taxo$species\n  ggtree(phylo_df, aes(col = site, alpha = site), layout = \"circular\") +\n    scale_color_manual(\n      guide = \"none\",\n      values = c(\"grey\", \"darkgreen\", \"grey\")\n    ) +\n    scale_alpha_manual(\n      guide = \"none\",\n      values = c(.1, 1, .1)\n    ) +\n    ggtitle(sit)\n}\nfigs &lt;- lapply(c(\n  \"Bafog\", \"Kabo\", \"Malinau\", \"Manare\", \"Montagne_Tortue\",\n  \"Paracou\", \"Tene\", \"Uppangala\"\n), phylo_site)\ncowplot::plot_grid(plotlist = figs)"
  },
  {
    "objectID": "14_functional.html#wood-density",
    "href": "14_functional.html#wood-density",
    "title": "Functional",
    "section": "Wood density",
    "text": "Wood density\n\n\nCode\ntaxo &lt;- read_tsv(\"data/derived_data/taxonomy_names_cleaned.tsv\")\nwd &lt;- getWoodDensity(taxo$genus_wfo, taxo$species_wfo) %&gt;%\n  group_by(genus, species) %&gt;%\n  summarise(wd = mean(meanWD)) %&gt;%\n  na.omit() %&gt;%\n  rename(genus_wfo = genus, species_wfo = species)\ntaxo_wd &lt;- left_join(taxo, wd)\ng1 &lt;- ggplot(taxo_wd, aes(wd, col = site)) +\n  geom_density() +\n  theme_bw() +\n  xlab(expression(\"Wood Density [\" ~ g / cm^3 ~ \"]\"))\ng2 &lt;- ggplot(taxo_wd, aes(site, wd, col = site)) +\n  geom_violin() +\n  geom_boxplot(width = .2) +\n  coord_flip() +\n  theme_bw() +\n  theme(\n    legend.position = \"none\",\n    axis.text.y = element_blank(),\n    axis.ticks.y = element_blank()\n  ) +\n  ylab(expression(\"Wood Density [\" ~ g / cm^3 ~ \"]\"))\ncowplot::plot_grid(g1, g2, nrow = 2)\n\n\n\n\n\nCaption."
  },
  {
    "objectID": "14_functional.html#try",
    "href": "14_functional.html#try",
    "title": "Functional",
    "section": "TRY",
    "text": "TRY\n\n\nCode\ntry_sp &lt;- read_tsv(\"data/derived_data/taxonomy_names_cleaned.tsv\") %&gt;%\n  select(scientificname_wfo) %&gt;%\n  na.omit() %&gt;%\n  unique() %&gt;%\n  left_join(read_tsv(\"data/raw_data/TryAccSpecies.txt\"),\n    by = c(\"scientificname_wfo\" = \"AccSpeciesName\")\n  )\nsp_req &lt;- try_sp %&gt;%\n  select(AccSpeciesID) %&gt;%\n  na.omit() %&gt;%\n  unique() %&gt;%\n  arrange() %&gt;%\n  mutate(request = rep(1:100, each = 200)[1:n()]) %&gt;%\n  group_by(request) %&gt;%\n  summarise(species_list = paste0(AccSpeciesID, collapse = \", \"))\nwrite_tsv(sp_req, \"outputs/try_species_requests.tvs\")\n\n\n\n\nCode\nread_tsv(\"outputs/try_species_requests.tvs\", n_max = 1) %&gt;%\n  kable(caption = \"Example of species ID list for TRY Data Explorer requests (limited to 200) for the first chunk.\")\n\n\n\nExample of species ID list for TRY Data Explorer requests (limited to 200) for the first chunk.\n\n\n\n\n\n\nrequest\nspecies_list\n\n\n\n\n1\n1797, 2458, 3147, 3257, 74617, 3383, 3446, 3494, 3806, 74946, 3875, 3877, 3878, 4136, 4160, 5583, 5598, 5605, 5937, 75885, 6197, 6614, 6816, 6817, 408207, 7610, 8569, 8576, 8580, 8582, 8980, 10273, 10716, 10852, 11045, 11219, 11345, 11353, 11365, 11952, 12134, 12272, 12649, 12657, 12678, 12681, 13282, 13692, 14156, 14300, 14450, 14860, 14866, 14882, 14890, 15557, 15619, 69478, 17195, 17542, 17778, 18719, 18800, 19480, 19522, 19578, 19696, 20479, 82381, 20736, 20744, 21873, 82839, 21888, 22242, 22256, 22258, 22261, 22269, 22273, 22275, 22281, 83448, 24884, 25648, 25858, 84130, 26519, 26812, 27124, 27177, 231856, 27264, 27269, 103114, 28222, 29126, 29162, 29250, 86017, 29655, 29808, 29811, 29834, 430787, 430788, 430797, 30545, 30552, 30586, 30609, 30614, 30624, 30632, 30575, 86888, 30895, 30904, 31131, 31260, 31278, 32096, 32613, 32615, 22272, 32627, 32629, 32634, 33288, 33295, 33330, 33334, 33335, 33337, 33343, 33380, 34387, 34690, 34856, 34870, 35216, 35358, 35441, 35446, 35649, 36681, 36684, 36686, 36689, 36897, 37293, 37333, 37540, 37888, 38516, 244626, 38544, 38551, 38552, 38573, 38574, 38616, 38676, 38677, 39233, 39234, 39236, 39604, 39724, 39875, 40231, 92496, 40311, 40317, 40357, 40360, 40367, 40368, 40645, 40823, 40831, 41051, 42597, 42632, 43008, 43542, 43587, 246054, 43763, 43766, 43767, 43772, 43775, 43810, 43817, 43828, 43836, 43843, 43845, 43853\n\n\n\n\n\n\n\nCode\nlist.files(\"data/raw_data\", full.names = TRUE, pattern = \"try_req\") %&gt;%\n  lapply(read_tsv, skip = 3) %&gt;%\n  lapply(gather, species, N, -Trait, -TraitID) %&gt;%\n  bind_rows() %&gt;%\n  filter(N &gt; 0) %&gt;%\n  group_by(Trait, TraitID) %&gt;%\n  summarise(N = n()) %&gt;%\n  filter(N &gt; 0.5 * 1255) %&gt;%\n  ggplot(aes(fct_rev(fct_infreq(Trait, N)), N)) +\n  geom_point() +\n  theme_bw() +\n  coord_flip() +\n  theme(axis.title = element_blank())\n\n\n\n\n\nTraits available for at least 50% of species available on TRY.\n\n\n\n\nWe will thus use:\n\n14: Leaf nitrogen (N) content per leaf dry mass\n3117: Leaf area per leaf dry mass (specific leaf area, SLA or 1/LMA): undefined if petiole is in- or excluded\n4: Stem specific density (SSD, stem dry mass per stem fresh volume) or wood density\n\n\nRequest in progress on TRY servers."
  },
  {
    "objectID": "14_functional.html#tallo",
    "href": "14_functional.html#tallo",
    "title": "Functional",
    "section": "Tallo",
    "text": "Tallo\n\n\nCode\ntallo &lt;- read_tsv(\"data/derived_data/taxonomy_names_cleaned.tsv\") %&gt;%\n  select(scientificname_wfo) %&gt;%\n  na.omit() %&gt;%\n  unique() %&gt;%\n  left_join(read_csv(\"data/raw_data/Tallo.csv?download=1\"),\n    by = c(\"scientificname_wfo\" = \"species\")\n  ) %&gt;%\n  filter(!is.na(tree_id))\ntallo %&gt;%\n  ggplot(aes(stem_diameter_cm, height_m)) +\n  geom_point(aes(col = scientificname_wfo), alpha = 0.25) +\n  theme_bw() +\n  geom_smooth(formula = y ~ log(x)) +\n  scale_color_discrete(guide = \"none\") +\n  xlab(\"diameter (cm)\") +\n  ylab(\"height (m)\") +\n  ggtitle(\"TALLO\", paste(length(unique(tallo$scientificname_wfo)), \"species\"))\n\n\n\n\n\nCaption.\n\n\n\n\nWe inferred hmax and ah using the following allometry in brms:\n\\[\n\\begin{array}{c}\nlog(height) \\sim N [ log(h_{max,s} \\times \\frac{dbh}{a_{h,s}+dbh^2}), \\sigma^2] \\\\\nh_{max,s} \\sim N (h_{max}, \\sigma_h^2) \\\\\na_{h,s} \\sim N (a_{h}, \\sigma_a^2)\n\\end{array}\n\\]\n\n\nCode\nlibrary(brms)\nlibrary(tidybayes)\nmdata &lt;- read_tsv(\"data/derived_data/taxonomy_names_cleaned.tsv\") %&gt;%\n  select(scientificname_wfo) %&gt;%\n  na.omit() %&gt;%\n  unique() %&gt;%\n  left_join(read_csv(\"data/raw_data/Tallo.csv?download=1\"),\n    by = c(\"scientificname_wfo\" = \"species\")\n  ) %&gt;%\n  filter(!is.na(tree_id)) %&gt;%\n  select(scientificname_wfo, height_m, stem_diameter_cm) %&gt;%\n  rename(h = height_m, d = stem_diameter_cm) %&gt;%\n  mutate(d = d / 100) %&gt;%\n  na.omit()\nfit &lt;- brm(\n  bf(log(h) ~ log(hmax * (d / (ah + d))),\n    hmax ~ 1 + 1 | scientificname_wfo,\n    ah ~ 1 + 1 | scientificname_wfo,\n    nl = TRUE\n  ),\n  prior = c(\n    prior(normal(40, 10), lb = 10, nlpar = \"hmax\"),\n    prior(normal(0.5, 0.5), lb = 0, nlpar = \"ah\")\n  ),\n  data = mdata, chains = 2, cores = 2, threads = 10\n)\nsave(mdata, fit, file = \"outputs/tallo_brms.Rdata\")\nfit %&gt;%\n  spread_draws(\n    b_hmax_Intercept, r_scientificname_wfo__hmax[scientificname_wfo, ],\n    b_ah_Intercept, r_scientificname_wfo__ah[scientificname_wfo, ]\n  ) %&gt;%\n  mutate(ah = b_ah_Intercept + r_scientificname_wfo__ah) %&gt;%\n  mutate(hmax = b_hmax_Intercept + r_scientificname_wfo__hmax) %&gt;%\n  group_by(scientificname_wfo) %&gt;%\n  summarise(ah = median(ah), hmax = median(hmax)) %&gt;%\n  mutate(scientificname_wfo = gsub(\".\", \" \", scientificname_wfo, fixed = TRUE)) %&gt;%\n  write_tsv(\"outputs/tallo_pars.tsv\")\n\n\nWe had good convergence and good post-predictive checks.\n\n\nCode\nload(\"outputs/tallo_brms.Rdata\")\nmcmc_rhat(bayesplot::rhat(fit$fit))\n\n\n\n\n\nGoodness of convergence assessed by Rhat. All Rhat are below 1.05 indicating a very good convergence of all chains.\n\n\n\n\n\n\nCode\nload(\"outputs/tallo_brms.Rdata\")\npp_check(fit)\n\n\n\n\n\nPosterior post-predictive check of simulated response variable against observed values indicating a good representation of the whole distribution in posteriors.\n\n\n\n\nWe thus inferred 494 (ah,hmax) couple of parameters.\n\n\nCode\nload(\"outputs/tallo_brms.Rdata\")\nsjPlot::tab_model(fit)\n\n\n\n\n\n \nlog(h)\n\n\nPredictors\nEstimates\nCI (95%)\n\n\nhmax_Intercept\n40.93\n39.57 – 42.37\n\n\nah_Intercept\n0.26\n0.25 – 0.27\n\n\nObservations\n13997\n\n\nR2 Bayes\n0.882\n\n\n\n\n\n\n\n\n\nCode\nread_tsv(\"data/derived_data/taxonomy_names_cleaned.tsv\") %&gt;%\n  left_join(read_tsv(\"outputs/tallo_pars.tsv\")) %&gt;%\n  filter(!is.na(ah)) %&gt;%\n  ggplot(aes(ah, hmax)) +\n  geom_point() +\n  theme_bw() +\n  facet_wrap(~site) +\n  xlab(expression(a[h])) +\n  ylab(expression(h[max]))\n\n\n\n\n\nInferred species allometric parameters hmax and ah and their relations per site.\n\n\n\n\n\n\nCode\ntaxo_hmax &lt;- read_tsv(\"data/derived_data/taxonomy_names_cleaned.tsv\") %&gt;%\n  left_join(read_tsv(\"outputs/tallo_pars.tsv\")) %&gt;%\n  filter(!is.na(hmax))\ng1 &lt;- ggplot(taxo_hmax, aes(hmax, col = site)) +\n  geom_density() +\n  theme_bw() +\n  ylab(expression(h[max]))\ng2 &lt;- ggplot(taxo_hmax, aes(site, hmax, col = site)) +\n  geom_violin() +\n  geom_boxplot(width = .2) +\n  coord_flip() +\n  theme_bw() +\n  theme(\n    legend.position = \"none\",\n    axis.text.y = element_blank(),\n    axis.ticks.y = element_blank()\n  ) +\n  ylab(expression(h[max]))\ncowplot::plot_grid(g1, g2, nrow = 2)\n\n\n\n\n\nInferred species allometric parameters hmax per site."
  },
  {
    "objectID": "14_functional.html#all",
    "href": "14_functional.html#all",
    "title": "Functional",
    "section": "All",
    "text": "All\n\n\nCode\ntaxo &lt;- read_tsv(\"data/derived_data/taxonomy_names_cleaned.tsv\")\nwd &lt;- getWoodDensity(taxo$genus_wfo, taxo$species_wfo) %&gt;%\n  group_by(genus, species) %&gt;%\n  summarise(wd = mean(meanWD)) %&gt;%\n  na.omit() %&gt;%\n  rename(genus_wfo = genus, species_wfo = species)\nh &lt;- read_tsv(\"outputs/tallo_pars.tsv\")\ntaxo_traits &lt;- left_join(taxo, wd) %&gt;%\n  left_join(h)\ntaxo_traits %&gt;%\n  select(wd, ah, hmax) %&gt;%\n  cor(use = \"pairwise.complete.obs\") %&gt;%\n  corrplot::corrplot(type = \"upper\", diag = FALSE)\n\n\n\n\n\nSpecies traits pairwise correlations."
  },
  {
    "objectID": "14_functional.html#imputation",
    "href": "14_functional.html#imputation",
    "title": "Functional",
    "section": "Imputation",
    "text": "Imputation\nWe used simple predictive mean matching (PMM) data imputation with mice.\n\n\nCode\nlibrary(mice)\nimputation &lt;- taxo_traits %&gt;%\n  select(scientificname, wd, ah, hmax) %&gt;%\n  mice(maxit = 100)\nimputation &lt;- filtered %&gt;%\n  mice::mice(maxit = 100)\ncomplete(imputation)\nwrite_tsv(\"outputs/traits_imputation.tsv\")\n\n\n\nCurrently we do not have enough data for imputation, waiting for TRY release.\n\n\n\n\n\nJucker, Tommaso, Fabian Jörg Fischer, Jérôme Chave, David A. Coomes, John Caspersen, Arshad Ali, Grace Jopaul Loubota Panzou, et al. 2022. “Tallo: A Global Tree Allometry and Crown Architecture Database.” Global Change Biology 28 (17): 5254–68. https://doi.org/10.1111/gcb.16302.\n\n\nKattge, Jens, Gerhard Bönisch, Sandra Díaz, Sandra Lavorel, Iain Colin Prentice, Paul Leadley, Susanne Tautenhahn, et al. 2019. “TRY Plant Trait Database  Enhanced Coverage and Open Access.” Global Change Biology 26 (1): 119–88. https://doi.org/10.1111/gcb.14904.\n\n\nRéjou-Méchain, Maxime, Ariane Tanguy, Camille Piponiot, Jérôme Chave, and Bruno Hérault. 2017. “Biomass: An r Package for Estimating Above-Ground Biomass and Its Uncertainty in Tropical Forests.” Edited by Sarah Goslee. Methods in Ecology and Evolution 8 (9): 1163–67. https://doi.org/10.1111/2041-210x.12753."
  },
  {
    "objectID": "99_references.html",
    "href": "99_references.html",
    "title": "References",
    "section": "",
    "text": "Jucker, Tommaso, Fabian Jörg Fischer, Jérôme Chave, David A. Coomes,\nJohn Caspersen, Arshad Ali, Grace Jopaul Loubota Panzou, et al. 2022.\n“Tallo: A Global Tree Allometry and Crown Architecture\nDatabase.” Global Change Biology 28 (17): 5254–68. https://doi.org/10.1111/gcb.16302.\n\n\nKattge, Jens, Gerhard Bönisch, Sandra Díaz, Sandra Lavorel, Iain Colin\nPrentice, Paul Leadley, Susanne Tautenhahn, et al. 2019. “TRY\nPlant Trait Database  Enhanced Coverage and Open\nAccess.” Global Change Biology 26 (1): 119–88. https://doi.org/10.1111/gcb.14904.\n\n\nRéjou-Méchain, Maxime, Ariane Tanguy, Camille Piponiot, Jérôme Chave,\nand Bruno Hérault. 2017. “Biomass: An r Package for Estimating\nAbove-Ground Biomass and Its Uncertainty in Tropical\nForests.” Edited by Sarah Goslee. Methods in Ecology and\nEvolution 8 (9): 1163–67. https://doi.org/10.1111/2041-210x.12753."
  }
]